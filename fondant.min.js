(function(){var e;e=jQuery,e(function(){var t;return t=function(){function t(e,t){this.init("fondant",e,t)}return t.prototype.init=function(t,n,r){return this.id=(new Date).getTime(),this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.templates.fondant=this,this.$element.prop("tagName").toLowerCase()==="textarea"&&(this.textarea=this.$element,this.replaceTextareaWithDiv()),this.makeEditable(),this.insertToolbar(),this.bindToolbar()},t.prototype.destroy=function(e){return e==null&&(e=!0),this.unbindToolbar(),this.removeToolbar(),this.makeUneditable(),this.textarea&&this.replaceDivWithTextarea(e),this.$element.removeData(this.type),delete this},t.prototype.focus=function(){return this.$element.find("."+this.templates.editorContentClass()).focus()},t.prototype.insertToolbar=function(){if(this.options.toolbar)return this.$element.prepend(this.templates.toolbar())},t.prototype.bindToolbar=function(){var t,n,r,i,s;i=this.actions,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(e("[data-action='"+this.type+"-"+t+"']").on("click.fondant",e.proxy(this[t],this)));return s},t.prototype.unbindToolbar=function(){if(!this.options.toolbar)return e("[data-action^='"+this.type+"-']").off(".fondant")},t.prototype.removeToolbar=function(){if(this.options.toolbar)return this.$element.find(this.options.prefix+"-toolbar").remove()},t.prototype.getElement=function(){return this.$element.get(0)},t.prototype.getOptions=function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data())},t.prototype.makeEditable=function(){return this.$element.attr("contenteditable","true"),this.$element=this.wrapEditorContent()},t.prototype.makeUneditable=function(){return this.$element=this.unwrapEditorContent(),this.$element.attr("contenteditable","false")},t.prototype.replaceElement=function(t,n){var r;return t.replaceWith(r=e(n)),r},t.prototype.replaceDivWithTextarea=function(e){var t;return e==null&&(e=!0),t=this.$element.html(),this.$element=this.replaceElement(this.$element,this.textarea),this.$element.data(this.type,this),e&&this.$element.val(t),this.$element},t.prototype.replaceTextareaWithDiv=function(){return this.textarea&&(this.$element=this.replaceElement(this.$element,this.templates.editorContent()),this.$element.data(this.type,this),this.$element.addClass(this.textarea.attr("class")),this.$element.html(this.textarea.val())),this.$element},t.prototype.unwrapEditorContent=function(){var e;return e=this.$element,this.$element=this.replaceElement(this.$element,this.$element.find("."+this.templates.editorContentClass())),this.$element.data(this.type,this),this.$element.addClass(this.templates.editorClass()),e.remove(),this.textarea&&this.$element.addClass(this.textarea.attr("class")),this.$element},t.prototype.wrapEditorContent=function(){var e;return e=this.$element,this.$element=this.$element.wrap(this.templates.editor()).parent(),this.$element.data(this.type,this),this.$element.addClass(e.attr("class")).removeClass(this.templates.editorContentClass()),e.removeClass(this.templates.editorClass()),e.removeData(this.type),this.textarea&&e.removeClass(this.textarea.attr("class")),this.$element},t.prototype.applyFormat=function(e,t){return document.execCommand(e,!1,t)},t.prototype.actions=["remove","custom","undo","redo","bold","italic","p","h1","h2","h3","h4","blockquote","ol","ul","indent","outdent","link","unlink"],t.prototype.remove=function(){return this.applyFormat("removeFormat")},t.prototype.custom=function(e){return navigator.appName==="Microsoft Internet Explorer"?console.log("Custom HTML not yet implemented"):this.applyFormat("insertHTML",e)},t.prototype.bold=function(){return this.applyFormat("bold")},t.prototype.italic=function(){return this.applyFormat("italic")},t.prototype.p=function(){return this.applyFormat("formatBlock","<p>")},t.prototype.h1=function(){return this.applyFormat("formatBlock","<h1>")},t.prototype.h2=function(){return this.applyFormat("formatBlock","<h2>")},t.prototype.h3=function(){return this.applyFormat("formatBlock","<h3>")},t.prototype.h4=function(){return this.applyFormat("formatBlock","<h4>")},t.prototype.blockquote=function(){return this.applyFormat("formatBlock","<blockquote>")},t.prototype.ol=function(){return this.applyFormat("insertOrderedList")},t.prototype.ul=function(){return this.applyFormat("insertUnorderedList")},t.prototype.indent=function(){return this.applyFormat("indent")},t.prototype.outdent=function(){return this.applyFormat("outdent")},t.prototype.link=function(e){return this.applyFormat("link",e)},t.prototype.unlink=function(){return this.applyFormat("unlink")},t.prototype.templates={editorClass:function(){return""+this.fondant.options.prefix+"-editor"},editorContentClass:function(){return""+this.editorClass()+"-content"},toolbarClass:function(){return""+this.fondant.options.prefix+"-toolbar"},editor:function(){var e;return e=""+this.fondant.options.prefix+"-"+this.fondant.id,'<div class="'+this.editorClass()+'" id="'+e+'">\n</div>'},editorContent:function(){return'<div class="'+this.editorClass()+" "+this.editorContentClass()+'">\n</div>'},toolbar:function(){return'<div class="'+this.toolbarClass()+'">\n  <ul>\n    <li>Text Styles</li>\n    <ul>\n      <li><a href="#" data-action="'+this.fondant.type+'-bold">B</a></li>\n      <li><a href="#" data-action="'+this.fondant.type+'-italic">I</a></li>\n    </ul>\n    <li>Block Styles</li>\n    <ul>\n      <li><a href="#" data-action="'+this.fondant.type+'-p">P</a></li>\n      <li><a href="#" data-action="'+this.fondant.type+'-h1">H1</a></li>\n      <li><a href="#" data-action="'+this.fondant.type+'-h2">H2</a></li>\n      <li><a href="#" data-action="'+this.fondant.type+'-h3">H3</a></li>\n      <li><a href="#" data-action="'+this.fondant.type+'-h4">H4</a></li>\n      <li><a href="#" data-action="'+this.fondant.type+'-blockquote">Quote</a></li>\n    </ul>\n    <li>Lists</li>\n    <ul>\n      <li><a href="#" data-action="'+this.fondant.type+'-ol">Numbers</a></li>\n      <li><a href="#" data-action="'+this.fondant.type+'-ul">Bullets</a></li>\n      <li><a href="#" data-action="'+this.fondant.type+'-indent">Increase Indent</a></li>\n      <li><a href="#" data-action="'+this.fondant.type+'-outdent">Decrease Indent</a></li>\n    </ul>\n  </ul>\n</div>'}},t}(),e.fn.fondant=function(){var n,r;return r=arguments[0],n=Array.prototype.slice.call(arguments).slice(1),this.map(function(){var i,s,o;return i=e(this),s=i.data("fondant"),o=typeof r=="object"&&r,s||i.data("fondant",s=new t(this,o)),typeof r=="string"&&s[r].apply(s,n),s.getElement()})},e.fn.fondant.defaults={prefix:"fondant",toolbar:!0}})}).call(this);